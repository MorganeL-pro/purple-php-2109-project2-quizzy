{% extends 'layout.html.twig' %}

{% block content %}
    <div class="js-container"></div>
    <h1>{{ question['title']}}</h1>
    <img src="assets/images/questions/question-image-{{ question['id'] }}.jpg" alt="question marks">
    {% for answer in answers %}
        <div>
            <input type="checkbox" id="{{ answer.id }}" name="{{ answer.title }}" disabled class="{{ (answer.is_correct) ? 'good-answer' : 'wrong-answer' }}">
            <label for="{{ answer.id }}">{{ answer.title }}</label>
        </div>
    {% endfor %}
    <div id="next-page-button">
        <a href="/" id="redirection">Question suivante (45)</a> <button type="button" id="pause-timer">Mettre en pause le timer</button>
    </div>
{% endblock %}


{% block javascript %}
    <script>
        //confetti actived if the good answer has been checked
        let fire = '{{ iscorrect }}';
        if (fire === '1') {
            var count = 200;
            var defaults = {
                origin: { y: 0.7 }
            };

            function fire(particleRatio, opts) {
                confetti(Object.assign({}, defaults, opts, {
                    particleCount: Math.floor(count * particleRatio)
                }));
            }

            fire(0.25, {
                spread: 26,
                startVelocity: 55,
            });
            fire(0.2, {
                spread: 60,
            });
            fire(0.35, {
                spread: 100,
                decay: 0.91,
                scalar: 0.8
            });
            fire(0.1, {
                spread: 120,
                startVelocity: 25,
                decay: 0.92,
                scalar: 1.2
            });
            fire(0.1, {
                spread: 120,
                startVelocity: 45,
            });
        }

        timer = 45;
        continueTimer = true;
        let x = setInterval(function() {
            if (continueTimer){
                timer -= 1;
            }
            document.getElementById("redirection").innerHTML = "Question suivante (" + timer + ")";
            if (timer <= 0 && continueTimer === true) {
                continueTimer = false;
                location.replace("/");
            }
        }, 1000);

        const pauseTimer = document.querySelector('#pause-timer');
        pauseTimer.addEventListener('click', function(){
            continueTimer = false;
        })
    </script>

{% endblock %}
